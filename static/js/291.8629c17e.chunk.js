"use strict";(self.webpackChunkmy_react_appo=self.webpackChunkmy_react_appo||[]).push([[291],{1291:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var r=a(9950),o=a(6491),n=a(5333),s=a(226),l=a(5277),i=a(2053),c=a(899),u=a(20),d=a(9890),g=a(6639),x=a(7901),p=a(2578),h=a(1975),m=a(294),y=a(2845),j=(a(6641),a(9246)),f=a(5271),A=a(9751),b=a(4414);const v=e=>{let{file:t,onRemove:a,index:s}=e;const[l,i]=(0,r.useState)("");return(0,r.useEffect)((()=>{if(t){const e=URL.createObjectURL(t);return i(e),()=>{URL.revokeObjectURL(e)}}}),[t]),(0,b.jsx)(o.A,{sx:{position:"relative",display:"inline-block"},children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("img",{src:l,alt:"Preview",style:{maxWidth:"100px",maxHeight:"100px"}}),(0,b.jsx)(n.A,{color:"error",size:"small",onClick:()=>a(t),sx:{position:"absolute",top:0,right:0},children:"\xd7"})]}):(0,b.jsx)(o.A,{sx:{width:"100px",height:"100px",border:"1px dashed gray",display:"flex",alignItems:"center",justifyContent:"center",color:"gray"},children:s+1})})},C=()=>{const[e,t]=(0,r.useState)(""),[a,C]=(0,r.useState)(""),[S,k]=(0,r.useState)(""),[E,w]=(0,r.useState)(""),[R,P]=(0,r.useState)(""),[I,D]=(0,r.useState)(""),[L,F]=(0,r.useState)(!1),[K,z]=(0,r.useState)(""),[T,U]=(0,r.useState)([]),[Z,O]=(0,r.useState)("Aerea"),[V,W]=(0,r.useState)(null),[G,N]=(0,r.useState)(null),[_,q]=(0,r.useState)([]),[B,M]=(0,r.useState)(!0),[Y,H]=(0,r.useState)(null);let Q="Otros";const[X,J]=(0,r.useState)([]),[$,ee]=(0,r.useState)([]),[te,ae]=(0,r.useState)([]),[re,oe]=(0,r.useState)({}),[ne,se]=(0,r.useState)(""),[le,ie]=(0,r.useState)(""),[ce,ue]=(0,r.useState)(""),de=(0,p.C3)(m.A),ge=(0,A.c7)(m.A),[xe,pe]=(0,r.useState)(null),[he,me]=(0,r.useState)([]),[ye,je]=(0,r.useState)([]),fe=()=>Date.now(),Ae=async(t,r)=>({Titulo:e,Categoria:Q,Subcategoria:"Otros",Codigo:t,Precio:parseInt(a),Peso:.6,Detalles:K,Vistos:0,Vendedor:"C0y1aQsV5NZNLBuvprio3vXy2LR2",Compras:0,Fecha:r,Descuento:0,Envio:"Aerea",Stock:!0,Dimension:.085,Pais:"China"}),be=async e=>{const t=[];try{for(let a=0;a<e.length;a++){const r=e[a];console.log(r,r.type);const o=(0,A.KR)(ge,"Imagenes/Productos/".concat(fe(),".jpeg"));await(0,A.D)(o,r);const n=await(0,A.qk)(o);t.push(n)}}catch(a){console.error("Error uploading images: ",a)}return t},ve=async(e,t)=>{const a={};return t.forEach((t=>{const r=(0,p.VC)((0,p.KR)(de,"GE/Exterior/Prod/".concat(e,"/imagenes")));a[r.key]={Codigo:r.key,Imagen:t}})),a},Ce=async e=>{const t={};return te.forEach((a=>{const r=(0,p.VC)((0,p.KR)(de,"GE/Exterior/Prod/".concat(e,"/Color")));t[r.key]={Codigo:r.key,label:a}})),t},Se=async e=>{const t={};return _.forEach((a=>{const r=(0,p.VC)((0,p.KR)(de,"GE/Exterior/Prod/".concat(e,"/Talla"))),o=parseInt(re[a])||0;t[r.key]={Codigo:r.key,label:a,precio:o}})),t},ke=async(e,t)=>{const a=(0,p.KR)(de,"GE/Filtros/Exterior/".concat(Q,"/").concat(e));await(0,p.hZ)(a,{Categoria:t.Categoria,Subcategoria:t.Subcategoria,Precio:t.Precio,Stock:t.Stock,Imagen:t.Imagen,Titulo:t.Titulo,Codigo:t.Codigo})},Ee=async e=>{M(!1),ue(e),console.log("Selected view: Exterior")};(0,r.useEffect)((()=>{if(""!==ce){}return()=>{}}),[ce]);const we=async e=>{try{const t=await j.A.get("http://localhost:3000/fetchWithPagination",{params:{path:"GE/Secciones/Exterior/".concat(e)}});console.log("Response status:",t.status),console.log("Response data:",t.data);const a=t.data;ee(a)}catch(t){console.error("Error fetching data:",t),t.response&&(console.error("Error response data:",t.response.data),console.error("Error response status:",t.response.status))}},[Re,Pe]=(0,r.useState)([]);return(0,b.jsxs)(o.A,{children:[(0,b.jsx)(y.A,{texto:"Publicar Prod"}),(0,b.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=async e=>{const t=new Uint8Array(e.target.result),a=f.LF(t,{type:"array"}),r=a.SheetNames[0],o=a.Sheets[r],n=f.Wp.sheet_to_json(o),s=await Promise.all(n.map((async e=>{let t=null;if(e.url)try{const a=await fetch(e.url),r=await a.blob();t=URL.createObjectURL(r)}catch(a){console.error("Error al descargar la imagen:",a)}return{...e,url:t||null,vendedor:"Desconocido",compras:Math.floor(100*Math.random())}})));Pe(s)},e.readAsArrayBuffer(t)}else alert("Por favor, selecciona un archivo primero")}}),B&&(0,b.jsxs)(o.A,{sx:{display:"flex",gap:5,m:10},children:[(0,b.jsx)(s.A,{variant:"contained",onClick:()=>Ee("Nacional"),children:"Nacional"}),(0,b.jsx)(s.A,{variant:"contained",onClick:()=>Ee("Exterior"),children:"Exterior"})]}),""!==ce&&(0,b.jsxs)(o.A,{component:"form",onSubmit:async e=>{e.preventDefault(),F(!0);let a=fe();try{const e=(0,p.VC)((0,p.KR)(de,"GE/Exterior/Prod")),r=e.key,o=await Ae(r,a);console.log(T,"kiee");const n=await be(T);console.log(n[0]),o.Imagen=n[0],o.Imagenes=await ve(r,n),o.Color=await Ce(r),_.length>0&&(o.Talla=await Se(r)),o[0]&&(o=o[0]),await(0,p.hZ)(e,o),await ke(r,o),F(!1),U([]),ae([]),q([]),t(""),z(""),C(""),alert("Data submitted successfully!")}catch(r){F(!1),alert("ERROR INESPERADO"),console.error("Transaction failed: ",r)}},sx:{padding:2,paddingTop:8},children:["Exterior"===ce&&(0,b.jsx)("div",{style:{margin:10},children:[{label:"Aerea",value:"Aerea"},{label:"Maritima",value:"Maritima"}].map((e=>(0,b.jsx)(l.A,{label:e.label,style:{margin:3},clickable:!0,onClick:()=>{return t=e.label,console.log(t),void(t!==Z&&O(t));var t},color:Z===e.label?"primary":"default"},e.value)))}),X.length>0&&(0,b.jsx)(i.A,{children:"Categorias"}),(0,b.jsx)("div",{style:{margin:10},children:X.map((e=>(0,b.jsx)(l.A,{label:e.seccion,style:{margin:3},clickable:!0,onClick:()=>{var t;(t=e.seccion)!==V&&(N(null),W(t),we(t))},color:V===e.seccion?"primary":"default"},e.icono)))}),$.length>0&&(0,b.jsx)(i.A,{children:"SubCategorias"}),(0,b.jsxs)("p",{children:[.6,Q]}),(0,b.jsx)("div",{style:{margin:10},children:$.map((e=>(0,b.jsx)(l.A,{label:e.seccion,style:{margin:3},clickable:!0,onClick:()=>{return t=e.seccion,void N(t);var t},color:G===e.seccion?"primary":"default"},e.icono)))}),(0,b.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,b.jsx)(c.Ay,{item:!0,xs:12,children:(0,b.jsx)(u.A,{label:"Title",variant:"outlined",value:e,onChange:e=>t((0,h.Zr)(e.target.value)),required:!0,fullWidth:!0})}),(0,b.jsx)(c.Ay,{item:!0,xs:12,children:(0,b.jsx)(u.A,{label:"Price",variant:"outlined",type:"number",value:a,onChange:e=>C(e.target.value),required:!0,fullWidth:!0})}),(0,b.jsx)(c.Ay,{item:!0,xs:12,children:(0,b.jsx)(u.A,{label:"Details",variant:"outlined",multiline:!0,rows:4,value:K,onChange:e=>z(e.target.value),required:!0,fullWidth:!0})}),(0,b.jsxs)("div",{style:{margin:10},children:[(0,b.jsx)(d.A,{value:ne,onChange:e=>se(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key||(e.preventDefault(),ne.trim()&&(ae([...te,(0,h.Zr)(ne.trim())]),se("")))},placeholder:"Introduzca Color"}),te.map(((e,t)=>(0,b.jsx)(l.A,{label:e,style:{margin:3},onDelete:()=>{return t=e,void ae(te.filter((e=>e!==t)));var t}},t)))]}),(0,b.jsxs)("div",{style:{margin:10},children:[(0,b.jsx)(d.A,{value:le,onChange:e=>ie(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key||(e.preventDefault(),le.trim()&&(q([..._,(0,h.Zr)(le.trim())]),oe({...re,[(0,h.Zr)(le.trim())]:""}),ie("")))},placeholder:"Introduzca Estilo"}),_.map(((e,t)=>(0,b.jsxs)(o.A,{display:"flex",alignItems:"center",marginY:1,children:[(0,b.jsx)(l.A,{label:e,style:{margin:3},onDelete:()=>(e=>{console.log("wettin"),q(_.filter((t=>t!==e)));const t={...re};delete t[e],oe(t)})(e)}),(0,b.jsx)(u.A,{label:"Price",type:"number",value:re[e]||"",onChange:t=>((e,t)=>{oe({...re,[t]:e.target.value})})(t,e),style:{marginLeft:"8px"}})]},t)))]}),(0,b.jsx)("img",{src:Y,alt:"Image",style:{width:"100%",height:"50%",objectFit:"contain",backgroundColor:"red"}}),(0,b.jsxs)(c.Ay,{item:!0,xs:12,children:[(0,b.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"Images (up to 5)"}),(0,b.jsx)(d.A,{type:"file",multiple:!0,accept:"image/*",onChange:e=>{const t=Array.from(e.target.files);t.length+T.length<=9?(t.forEach((e=>{console.log("File: ".concat(e.name,", Size: ").concat((e.size/1024).toFixed(2)," KB"))})),U([...T,...t])):alert("You can upload up to 9 images only.")},required:!0,startAdornment:(0,b.jsx)(n.A,{color:"primary","aria-label":"upload pictures",component:"label",children:(0,b.jsx)(x.A,{})})}),(0,b.jsx)(o.A,{sx:{mt:2,display:"flex",flexWrap:"wrap",gap:2},children:T.map(((e,t)=>(0,b.jsx)(v,{file:e,onRemove:()=>(e=>{U(T.filter(((t,a)=>a!==e)))})(t),index:t},t)))})]}),(0,b.jsx)(c.Ay,{item:!0,xs:12,display:"flex",justifyContent:"center",alignItems:"center",children:(0,b.jsx)(s.A,{type:"submit",variant:"contained",color:"primary",children:L?(0,b.jsx)(g.A,{color:"warning",size:24}):"PUBLICAR"})})]})]})]})}},2845:(e,t,a)=>{a.d(t,{A:()=>d});var r=a(9950),o=a(8429),n=a(4857),s=a(6589),l=a(5333),i=a(3189),c=a(4414);const u=e=>{let{texto:t}=e;const a=(0,n.A)(),r=(0,s.A)(a.breakpoints.down("sm")),u=(0,o.Zp)();return(0,c.jsx)(c.Fragment,{children:r&&(0,c.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:60,padding:a.spacing(1),backgroundColor:a.palette.background.paper,boxShadow:a.shadows[2],display:"flex",alignItems:"center",zIndex:1e3,boxSizing:"border-box"},children:[(0,c.jsx)(l.A,{onClick:()=>u(-1),"aria-label":"back",children:(0,c.jsx)(i.A,{})}),(0,c.jsx)("h2",{style:{marginLeft:a.spacing(2)},children:t})]})})},d=r.memo(u)}}]);